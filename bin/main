#!/usr/bin/env ruby

require './lib/scraper'
require './lib/display'

module InteractUser
  def welcome
    puts 'Welcome to Minecraft News from'
    puts 'minecraftglobal.com'
  end

  def get_anwser(arr)
    something = true
    while something
      puts 'Do you want all the news?(y/n):'
      anwser = gets.chomp
      case anwser.upcase
      when 'Y'
        puts 'Here you have'
        sleep 1
        puts arr
        return anwser
        something = false
      when 'N'
        puts 'im sorry to ear that'
        return anwser
        something = false
      else
        puts 'wrong input'
      end
    end
  end

  def title(title, arr, mine_news)
    if title.upcase == 'N'
      keep = true
      while keep
        puts 'Would you like to read the titles?(y/n)'
        anwser = gets.chomp
        case anwser.upcase
        when 'Y'
          puts 'Here you have'
          sleep 2
          puts mine_news.display_titles(arr)
          return anwser.upcase
          break
        when 'N'
          return anwser.upcase
          break
        else
          puts 'wrong input'
        end
      end
    else
      puts 'Thanks return soon'
      sleep 1
      exit
    end
  end

  def selection(title, arr, mine_news)
    if title == 'Y'
      puts 'do you want to read an specific news?(y/n)'
      specific_new = gets.chomp
      case specific_new.upcase
      when 'Y'
        keep = true
        while keep
          puts 'Select news from 1 to 10'
          selected_news = gets.chomp.to_i
          if selected_news.positive? && selected_news < 11
            puts selected_news
            puts 'Here you have'
            sleep 2
            puts mine_news.display_specific(selected_news, arr)
            puts 'Thank you for prefer us'
            break
          else
            puts 'not a valid input try again'
          end
        end
      when 'N'
        puts 'Thanks return soon'
      else
        puts 'wrong input'
        selection_anwser(title, arr, minecraft_news)
      end
    else
      puts 'Thanks return soon'
      sleep 1
      exit
    end
  end
end

class StartScraper
  include InteractUser
  def start
    minecraft = Scraper.new.display
    minecraft_news = DisplayForms.new
    welcome
    anwser = get_anwser(minecraft)
    title = title(anwser, minecraft, minecraft_news)
    selection(title, minecraft, minecraft_news)
  end
end

StartScraper.new.start
