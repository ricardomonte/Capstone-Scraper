#!/usr/bin/env ruby

require './lib/scraper'
require './lib/display'

module InteractUser
  def welcome
    puts 'Welcome to Minecraft News from'
    puts 'minecraftglobal.com'
  end

  def looping(ask)
    loop do
      puts ask
      anwser = gets.chomp.upcase
      break anwser if anwser == 'Y'
      break anwser if anwser == 'N'

      puts 'wrong input try again'
    end
  end

  def looping_selection(ask)
    loop do
      puts ask
      anwser = gets.chomp.to_i
      break anwser if anwser.positive? && anwser < 11

      puts 'wrong input try again'
    end
  end

  def getting_anwser(arr)
    question = 'Do you want all the news?(y/n):'
    anwser = looping(question)
    case anwser
    when 'Y'
      puts 'Here you have'
      sleep 1
      puts arr
      anwser
    when 'N'
      anwser
    end
  end

  def title(title, arr, mine_news)
    if title == 'N'
      question = 'Would you like to read the titles?(y/n)'
      anwser = looping(question)
      case anwser
      when 'Y'
        puts 'Here you have'
        sleep 2
        puts mine_news.display_titles(arr)
        return anwser.upcase
      when 'N'
        return anwser.upcase
      end
    end
    puts 'Thanks return soon'
    sleep 1
    exit
  end

  def selection(title, arr, mine_news)
    if title == 'Y'
      question = 'do you want to read an specific news?(y/n)'
      specific_new = looping(question)
      case specific_new
      when 'Y'
        question_num = 'Select news from 1 to 10'
        number = looping_selection(question_num)
        puts 'Here you have'
        sleep 2
        puts mine_news.display_specific(number, arr)
        puts 'Thank you for prefer us'
      when 'N'
        puts 'Thanks return soon'
      end
    else
      puts 'Thanks return soon'
      sleep 1
      exit
    end
  end
end

class StartScraper
  include InteractUser
  def start
    minecraft = Scraper.new.display
    minecraft_news = DisplayForms.new
    welcome
    anwser = getting_anwser(minecraft)
    title = title(anwser, minecraft, minecraft_news)
    selection(title, minecraft, minecraft_news)
  end
end

StartScraper.new.start
